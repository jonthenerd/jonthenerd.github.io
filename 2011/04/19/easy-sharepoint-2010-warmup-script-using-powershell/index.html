<!DOCTYPE html>
<html lang="en">
    <head prefix="og: http://ogp.me/ns#">
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="HandheldFriendly" content="True" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <title>Easy SharePoint 2010 warmup Script using PowerShell &ndash; JonTheNerd</title>
        <meta name="description" content="This idea comes from Kirk Hofer&rsquo;s blog, but modfied to use the SharePoint 2010 powershell commandlets and not care about specifying credentials in the script. I figured most people would just keep using the credentials specified in their scheduled task. The script loads the SharePoint plugin, enumerates the zones, and sends a request to each one.
Add-PSSnapin Microsoft.SharePoint.PowerShell; function Get-WebPage([string]$url) { $wc = new-object net.webclient; $wc.credentials = [System.Net.CredentialCache]::DefaultCredentials; $pageContents = $wc." />
        <meta name="color-scheme" content="dark light" />
        <script>
            
            if (window.matchMedia("(prefers-color-scheme: dark)").media ==="not all") {
                document.documentElement.style.display = "none";
                document.head.insertAdjacentHTML(
                    "beforeend",
                    '<link rel="stylesheet" href="/assets/light.css" onload="document.documentElement.style.display = \'\'">'
                );
            }
        </script>
        <link rel="stylesheet" media="(prefers-color-scheme: light)" href="/assets/light.css" />
        <link rel="stylesheet" media="(prefers-color-scheme: dark)" href="/assets/dark.css" />
        <link rel="stylesheet" href="/assets/style.css" />
        
        <script src="/assets/scripts/main.js" defer></script>
        <link rel="canonical" href="http://www.jonthenerd.com/2011/04/19/easy-sharepoint-2010-warmup-script-using-powershell/">
    </head>
    <body>
        <header class="site-header">
    <h1>
        <a href="/">JonTheNerd</a>
    </h1>
    <nav>
        <ul>
            <li><a href="/about">About</a></li>
        </ul>
    </nav>
</header>

        <main>
            
<article class="single" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
        <h1 itemprop="name headline">
            <div class="container">Easy SharePoint 2010 warmup Script using PowerShell</div>
        </h1>
        <div class="post-meta">
            <div class="container">
                <time datetime=" 2011-04-19" itemprop="datePublished">April 19, 2011</time>
                by <span itemprop="author" itemscope itemtype="https://schema.org/Person">
                    <a itemprop="url" href="/about"><span itemprop="name">Jon Badgett</span></a>
                </span>
                
                | Posted in
                <a
                    href="/categories/sysadmin">SysAdmin</a>
                
                
                | Tagged with
                <a
                    href="/tags/sharepoint">SharePoint</a>, <a
                    href="/tags/powershell">PowerShell</a>
                
            </div>
        </div>
    </header>
    <div itemprop="articleBody">
        <div class="container">
            <p>This idea comes from
<a href="http://kirkhofer.wordpress.com/2008/10/18/sharepoint-warm-up-script/">Kirk Hofer&rsquo;s blog</a>, but modfied to use the SharePoint 2010 powershell commandlets
and not care about specifying credentials in the script. I figured most people
would just keep using the credentials specified in their scheduled task. The
script loads the SharePoint plugin, enumerates the zones, and sends a request to
each one.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Add-PSSnapin</span> <span class="n">Microsoft</span><span class="p">.</span><span class="py">SharePoint</span><span class="p">.</span><span class="n">PowerShell</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Get-WebPage([string]$url</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$wc</span> <span class="p">=</span> <span class="nb">new-object</span> <span class="n">net</span><span class="p">.</span><span class="n">webclient</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$wc</span><span class="p">.</span><span class="py">credentials</span> <span class="p">=</span> <span class="p">[</span><span class="no">System.Net.CredentialCache</span><span class="p">]::</span><span class="n">DefaultCredentials</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$pageContents</span> <span class="p">=</span> <span class="nv">$wc</span><span class="p">.</span><span class="py">DownloadString</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$wc</span><span class="p">.</span><span class="py">Dispose</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$pageContents</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Get-SPAlternateUrl</span> <span class="n">-Zone</span> <span class="k">Default</span> <span class="p">|</span> <span class="nb">foreach-object</span> <span class="p">{</span> <span class="nb">write-host</span> <span class="nv">$_</span><span class="p">.</span><span class="n">IncomingUrl</span><span class="p">;</span> <span class="nv">$html</span> <span class="p">=</span> <span class="nb">Get-WebPage</span> <span class="n">-url</span> <span class="nv">$_</span><span class="p">.</span><span class="n">IncomingUrl</span><span class="p">;</span> <span class="p">}</span>
</span></span></code></pre></div>
        </div>
    </div>
</article>

        </main>
        <div class="feedback">
    <div class="container">
        <div id="disqus_thread"></div>
    </div>
</div>
<script>
    var disqus_config = function () {
        this.page.url = "http:\/\/www.jonthenerd.com\/2011\/04\/19\/easy-sharepoint-2010-warmup-script-using-powershell\/";  
    };
    (function () {
        var d = document, s = d.createElement('script');
        s.src = 'https://jonthenerd.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        s.setAttribute("defer", "defer");
        (d.head || d.body).appendChild(s);
    })();
</script>


        <footer>
    <div class="container">
        built with <a href="https://gohugo.io/">Hugo</a> and <a href="https://github.com/jonthenerd/jonthenerd.github.io">GitHub Pages</a> | <a href="/license">License</a> | <span id="theme-toggle" role="button"></span>
    </div>
</footer>

    </body>
</html>
