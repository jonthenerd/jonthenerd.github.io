<!DOCTYPE html>
<html lang="en">
    <head prefix="og: http://ogp.me/ns#">
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="HandheldFriendly" content="True" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="description" content="Jon Badgett's personal blog. Open source projects, observations on life, and other oddities I find interesting." />
        <title>SharePoint 2010: Finding the largest document library in a site collection &ndash; JonTheNerd</title>
        <meta name="color-scheme" content="dark light" />
        <script>
            if (window.matchMedia("(prefers-color-scheme: dark)").media ==="not all") {
                document.documentElement.style.display = "none";
                document.head.insertAdjacentHTML(
                    "beforeend",
                    '<link rel="stylesheet" href="/assets/light.css" onload="document.documentElement.style.display = \'\'">'
                );
            }
        </script>
        <link rel="stylesheet" media="(prefers-color-scheme: light)" href="/assets/light.css" />
        <link rel="stylesheet" media="(prefers-color-scheme: dark)" href="/assets/dark.css" />
        <link rel="stylesheet" href="/assets/style.css" />
        
        <link rel="canonical" href="http://www.jonthenerd.com/2011/08/16/sharepoint-2010-findinglargestdoclibrary/">
    </head>
    <body>
        <header class="site-header">
    <div class="container">
        <h1>
            <a href="/">JonTheNerd</a>
        </h1>
        <nav>
            <ul>
                <li><a href="/about">About</a></li>
            </ul>
        </nav>
    </div>
</header>

        <main>
            
<article class="single" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
        <h1 itemprop="name headline">
            <div class="container">SharePoint 2010: Finding the largest document library in a site collection</div>
        </h1>
        <div class="post-meta">
            <div class="container">
                <time datetime=" 2011-08-16" itemprop="datePublished">August 16, 2011</time>
                
                | Posted in
                <a
                    href="/categories/sysadmin">SysAdmin</a>, <a
                    href="/categories/programming">Programming</a>
                
                
                | Tagged with
                <a
                    href="/tags/powershell">PowerShell</a>, <a
                    href="/tags/sharepoint">SharePoint</a>
                
            </div>
        </div>
    </header>
    <div itemprop="articleBody">
        <div class="container">
            <p>SharePoint 2007 came with a page (storman.aspx) dedicated to showing you how
much space each of the lists in your site collection were taking up. SharePoint
2010 removed this page. Luckily, SharePoint 2010 SP1 added it back in. But what
if you&rsquo;re still haven&rsquo;t updated to SP1 and you&rsquo;re getting warnings/errors about
running out of space?</p>
<p>Obviously - up the space so as to avoid additional noise from your users. Then -
figure out which libraries are taking up the most space. This can be done by
using the (now obsolete - but working)
<a href="http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spsite.storagemanagementinformation.aspx">StorageManagementInformation
method off of SPSite</a>. You can write some C# to use it, or you can use
PowerShell.</p>
<p>The required arguments for this method (listed below) can be found by looking at
the above MSDN link. I&rsquo;ll also include the potential values that can be found by
using Reflector to look at the Microsoft.SharePoint dll:</p>
<!-- raw HTML omitted -->
<p>So if you want to find the top 5 largest document libraries in a specific site
collection, here&rsquo;s the PowerShell:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-posh" data-lang="posh"><span class="line"><span class="cl"><span class="nv">$site</span> <span class="p">=</span> <span class="nb">Get-SPSite</span> <span class="s2">&#34;http://yoursitecollection:portifneeded&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$dataTable</span> <span class="p">=</span> <span class="nv">$site</span><span class="p">.</span><span class="py">StorageManagementInformation</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="n">0x11</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$dataTable</span> <span class="p">|</span> <span class="nb">Select </span><span class="p">*</span>
</span></span></code></pre></div><p>This is very helpful if you aren&rsquo;t yet on SP2010 SP1. A note though - the method
is marked as obselete with this description &ldquo;SPSite.StorageManagementInformation
is expensive; avoid using it.&rdquo;. There&rsquo;s no further explanation on what is being
spooled up to execute the method or why it was OK in SP2007 but not SP2010. So
I&rsquo;d consider this OK to use if you have to&hellip;but not in some kind of recurring
scheduled script. Your mileage may vary, I&rsquo;m not responsible for what happens to
your farm, etc. etc.</p>
<p>Hope you found this useful. Let me know!</p>

        </div>
    </div>
</article>

        </main>
        <div class="feedback">
    <div class="container">
        <div id="disqus_thread"></div>
    </div>
</div>
<script>
    var disqus_config = function () {
        this.page.url = "http:\/\/www.jonthenerd.com\/2011\/08\/16\/sharepoint-2010-findinglargestdoclibrary\/";  
    };
    (function () {
        var d = document, s = d.createElement('script');
        s.src = 'https://jonthenerd.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        s.setAttribute("defer", "defer");
        (d.head || d.body).appendChild(s);
    })();
</script>


        <footer>
    <div class="container">
        built with <a href="https://gohugo.io/">Hugo</a> and <a href="https://github.com/jonthenerd/jonthenerd.github.io">GitHub Pages</a> | <a href="/license">License</a>
    </div>
</footer>

    </body>
</html>
