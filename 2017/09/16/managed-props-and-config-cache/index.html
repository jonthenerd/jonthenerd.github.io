<!DOCTYPE html>
<html lang="en">
    <head prefix="og: http://ogp.me/ns#">
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="HandheldFriendly" content="True" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <title>SharePoint: Search Managed Properties missing after full crawl &ndash; JonTheNerd</title>
        <meta name="description" content="Scenario:

SharePoint 2013
You&rsquo;ve created some site columns, added them to a content type, then added
that content type to a list/library.
You add some test data.
Run a full crawl.
Create managed properties, mapping them to the crawled properties.
Run another full crawl (to populate the managed properties)
Managed properties on search results are missing.

What do you do now?" />
        <meta name="color-scheme" content="dark light" />
        <script>
            
            if (window.matchMedia("(prefers-color-scheme: dark)").media ==="not all") {
                document.documentElement.style.display = "none";
                document.head.insertAdjacentHTML(
                    "beforeend",
                    '<link rel="stylesheet" href="/assets/light.css" onload="document.documentElement.style.display = \'\'">'
                );
            }
        </script>
        <link rel="stylesheet" media="(prefers-color-scheme: light)" href="/assets/light.css" />
        <link rel="stylesheet" media="(prefers-color-scheme: dark)" href="/assets/dark.css" />
        <link rel="stylesheet" href="/assets/style.css" />
        
        <script src="/assets/scripts/main.js" defer></script>
        <link rel="canonical" href="http://www.jonthenerd.com/2017/09/16/managed-props-and-config-cache/">
    </head>
    <body>
        <header class="site-header">
    <h1>
        <a href="/">JonTheNerd</a>
    </h1>
    <nav>
        <ul>
            <li><a href="/about">About</a></li>
        </ul>
    </nav>
</header>

        <main>
            
<article class="single" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
        <h1 itemprop="name headline">
            <div class="container">SharePoint: Search Managed Properties missing after full crawl</div>
        </h1>
        <div class="post-meta">
            <div class="container">
                <time datetime=" 2017-09-16" itemprop="datePublished">September 16, 2017</time>
                
                | Posted in
                <a
                    href="/categories/sysadmin">SysAdmin</a>
                
                
                | Tagged with
                <a
                    href="/tags/sharepoint">SharePoint</a>
                
            </div>
        </div>
    </header>
    <div itemprop="articleBody">
        <div class="container">
            <p>Scenario:</p>
<ul>
<li>SharePoint 2013</li>
<li>You&rsquo;ve created some site columns, added them to a content type, then added
that content type to a list/library.</li>
<li>You add some test data.</li>
<li>Run a full crawl.</li>
<li>Create managed properties, mapping them to the crawled properties.</li>
<li>Run another full crawl (to populate the managed properties)</li>
<li>Managed properties on search results are missing.</li>
</ul>
<p>What do you do now?</p>
<ul>
<li>Run another full crawl and check again.</li>
<li>Wonder why it&rsquo;s still not working.</li>
</ul>
<p>What else has worked for me? Clear the SharePoint Config Cache. This is
referenced in a
<a href="https://sharepoint.stackexchange.com/questions/122486/new-managed-properties-dont-contain-values">Stack Overflow Question</a>
and it references a
<a href="https://blogs.technet.microsoft.com/sp/?p=373">Technet article</a>. However, the
SO question is out of date with the article and the article has some incorrect
quotes, making copy+paste fail. Here&rsquo;s the technet article code cleaned up a
bit.</p>
<p>After clearing the config cache, run a full crawl. I&rsquo;ve had success in this
allowing Managed Properties to be populated with data and present when the above
steps didn&rsquo;t work.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Add-PSSnapin</span> <span class="n">-Name</span> <span class="n">Microsoft</span><span class="p">.</span><span class="py">SharePoint</span><span class="p">.</span><span class="py">PowerShell</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">write-host</span> <span class="s2">&#34;CLEAR CONFIG CACHE ON FARM&#34;</span> <span class="o">-F</span> <span class="n">Green</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$servers</span> <span class="p">=</span> <span class="nb">get-spserver</span> <span class="p">|</span> <span class="p">?{</span><span class="nv">$_</span><span class="p">.</span><span class="py">role</span> <span class="o">-eq</span> <span class="s2">&#34;Application&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">foreach</span> <span class="p">(</span><span class="nv">$server</span> <span class="k">in</span> <span class="nv">$servers</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$servername</span> <span class="p">=</span> <span class="nv">$server</span><span class="p">.</span><span class="n">Address</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">write-host</span> <span class="s2">&#34;Stop Timer Service on server </span><span class="nv">$servername</span><span class="s2">&#34;</span> <span class="o">-F</span> <span class="n">Yellow</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nb">Get-WmiObject</span> <span class="n">Win32_Service</span> <span class="n">-filter</span> <span class="s2">&#34;name=&#39;SPTimerV4&#39;&#34;</span> <span class="n">-ComputerName</span> <span class="nv">$servername</span><span class="p">).</span><span class="py">stopservice</span><span class="p">()</span> <span class="p">|</span> <span class="nb">Out-Null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">foreach</span> <span class="p">(</span><span class="nv">$server</span> <span class="k">in</span> <span class="nv">$servers</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$servername</span> <span class="p">=</span> <span class="nv">$server</span><span class="p">.</span><span class="n">Address</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$folders</span> <span class="p">=</span> <span class="nb">Get-ChildItem</span> <span class="p">(</span><span class="s2">&#34;\\&#34;</span> <span class="p">+</span> <span class="nv">$servername</span> <span class="p">+</span> <span class="s2">&#34;\C$\ProgramData\Microsoft\SharePoint\Config&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$folder</span> <span class="k">in</span> <span class="nv">$folders</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$items</span> <span class="p">=</span> <span class="nb">Get-ChildItem</span> <span class="nv">$folder</span><span class="p">.</span><span class="py">FullName</span> <span class="n">-Recurse</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$item</span> <span class="k">in</span> <span class="nv">$items</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nv">$item</span><span class="p">.</span><span class="py">Name</span><span class="p">.</span><span class="py">ToLower</span><span class="p">()</span> <span class="o">-eq</span> <span class="s2">&#34;cache.ini&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$cachefolder</span> <span class="p">=</span> <span class="nv">$folder</span><span class="p">.</span><span class="n">FullName</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">write-host</span> <span class="s2">&#34;Found CacheFolder on Server </span><span class="nv">$servername</span><span class="s2"> = </span><span class="nv">$cachefolder</span><span class="s2">&#34;</span> <span class="o">-F</span> <span class="n">Yellow</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$cachefolderitems</span> <span class="p">=</span> <span class="nb">Get-ChildItem</span> <span class="nv">$cachefolder</span> <span class="n">-Recurse</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">write-host</span> <span class="s2">&#34;Delete all XMQL Files inside this CacheFolder&#34;</span> <span class="o">-F</span> <span class="n">Yellow</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$cachefolderitem</span> <span class="k">in</span> <span class="nv">$cachefolderitems</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$cachefolderitem</span> <span class="o">-like</span> <span class="s2">&#34;*.xml&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$cachefolderitem</span><span class="p">.</span><span class="py">Delete</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$a</span> <span class="p">=</span> <span class="nb">Get-Content</span> <span class="nv">$cachefolder</span><span class="p">\</span><span class="n">cache</span><span class="p">.</span><span class="n">ini</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$a</span> <span class="p">=</span> <span class="mf">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">write-host</span> <span class="s2">&#34;Creating a new Cache.ini File on server </span><span class="nv">$servername</span><span class="s2">&#34;</span> <span class="o">-F</span> <span class="n">Yellow</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Set-Content</span> <span class="nv">$a</span> <span class="n">-Path</span> <span class="nv">$cachefolder</span><span class="p">\</span><span class="n">cache</span><span class="p">.</span><span class="n">ini</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">foreach</span> <span class="p">(</span><span class="nv">$server</span> <span class="k">in</span> <span class="nv">$servers</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$servername</span> <span class="p">=</span> <span class="nv">$server</span><span class="p">.</span><span class="n">Address</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">write-host</span> <span class="s2">&#34;START Timer Service on server </span><span class="nv">$servername</span><span class="s2">&#34;</span> <span class="o">-F</span> <span class="n">Yellow</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nb">Get-WmiObject</span> <span class="n">Win32_Service</span> <span class="n">-filter</span> <span class="s2">&#34;name=&#39;SPTimerV4&#39;&#34;</span> <span class="n">-ComputerName</span> <span class="nv">$servername</span><span class="p">).</span><span class="py">startservice</span><span class="p">()</span> <span class="p">|</span> <span class="nb">Out-Null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div>
        </div>
    </div>
</article>

        </main>
        <div class="feedback">
    <div class="container">
        <div id="disqus_thread"></div>
    </div>
</div>
<script>
    var disqus_config = function () {
        this.page.url = "http:\/\/www.jonthenerd.com\/2017\/09\/16\/managed-props-and-config-cache\/";  
    };
    (function () {
        var d = document, s = d.createElement('script');
        s.src = 'https://jonthenerd.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        s.setAttribute("defer", "defer");
        (d.head || d.body).appendChild(s);
    })();
</script>


        <footer>
    <div class="container">
        built with <a href="https://gohugo.io/">Hugo</a> and <a href="https://github.com/jonthenerd/jonthenerd.github.io">GitHub Pages</a> | <a href="/license">License</a> | <span id="theme-toggle" role="button"></span>
    </div>
</footer>

    </body>
</html>
