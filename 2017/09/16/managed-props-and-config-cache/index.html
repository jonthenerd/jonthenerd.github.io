<!DOCTYPE html>
<html lang="en">
    <head prefix="og: http://ogp.me/ns#">
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="HandheldFriendly" content="True" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="description" content="Jon Badgett's personal blog. Open source projects, observations on life, and other oddities I find interesting." />
        <title>SharePoint: Search Managed Properties missing after full crawl &ndash; JonTheNerd</title>
        <meta name="color-scheme" content="dark light" />
        <script>
            if (window.matchMedia("(prefers-color-scheme: dark)").media ==="not all") {
                document.documentElement.style.display = "none";
                document.head.insertAdjacentHTML(
                    "beforeend",
                    '<link rel="stylesheet" href="/assets/light.css" onload="document.documentElement.style.display = \'\'">'
                );
            }
        </script>
        <link rel="stylesheet" media="(prefers-color-scheme: light)" href="/assets/light.css" />
        <link rel="stylesheet" media="(prefers-color-scheme: dark)" href="/assets/dark.css" />
        <link rel="stylesheet" href="/assets/style.css" />
        
    </head>
    <body>
        <header class="site-header">
    <div class="container">
        <h1>
            <a href="/">JonTheNerd</a>
        </h1>
        <nav>
            <ul>
                <li><a href="/about">About</a></li>
            </ul>
        </nav>
    </div>
</header>

        <main>
            
<article class="single" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
        <h1 itemprop="name headline">
            <div class="container">SharePoint: Search Managed Properties missing after full crawl</div>
        </h1>
        <div class="post-meta">
            <div class="container">
                <time datetime=" 2017-09-16" itemprop="datePublished">September 16, 2017</time>
                
                | Posted in
                <a
                    href="/categories/sysadmin">SysAdmin</a>
                
                
                | Tagged with
                <a
                    href="/tags/sharepoint">SharePoint</a>
                
            </div>
        </div>
    </header>
    <div itemprop="articleBody">
        <div class="container">
            <p>Scenario:</p>
<ul>
<li>SharePoint 2013</li>
<li>You&rsquo;ve created some site columns, added them to a content type, then added
that content type to a list/library.</li>
<li>You add some test data.</li>
<li>Run a full crawl.</li>
<li>Create managed properties, mapping them to the crawled properties.</li>
<li>Run another full crawl (to populate the managed properties)</li>
<li>Managed properties on search results are missing.</li>
</ul>
<p>What do you do now?</p>
<ul>
<li>Run another full crawl and check again.</li>
<li>Wonder why it&rsquo;s still not working.</li>
</ul>
<p>What else has worked for me? Clear the SharePoint Config Cache. This is
referenced in a
<a href="https://sharepoint.stackexchange.com/questions/122486/new-managed-properties-dont-contain-values">Stack Overflow Question</a>
and it references a
<a href="https://blogs.technet.microsoft.com/sp/?p=373">Technet article</a>. However, the
SO question is out of date with the article and the article has some incorrect
quotes, making copy+paste fail. Here&rsquo;s the technet article code cleaned up a
bit.</p>
<p>After clearing the config cache, run a full crawl. I&rsquo;ve had success in this
allowing Managed Properties to be populated with data and present when the above
steps didn&rsquo;t work.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Add-PSSnapin</span> <span class="n">-Name</span> <span class="n">Microsoft</span><span class="p">.</span><span class="n">SharePoint</span><span class="p">.</span><span class="n">PowerShell</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">write-host</span> <span class="s2">&#34;CLEAR CONFIG CACHE ON FARM&#34;</span> <span class="o">-F</span> <span class="n">Green</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$servers</span> <span class="p">=</span> <span class="nb">get-spserver</span> <span class="p">|</span> <span class="p">?{</span><span class="nv">$_</span><span class="p">.</span><span class="n">role</span> <span class="o">-eq</span> <span class="s2">&#34;Application&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">foreach</span> <span class="p">(</span><span class="nv">$server</span> <span class="k">in</span> <span class="nv">$servers</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$servername</span> <span class="p">=</span> <span class="nv">$server</span><span class="p">.</span><span class="n">Address</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">write-host</span> <span class="s2">&#34;Stop Timer Service on server $servername&#34;</span> <span class="o">-F</span> <span class="n">Yellow</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nb">Get-WmiObject</span> <span class="n">Win32_Service</span> <span class="n">-filter</span> <span class="s2">&#34;name=&#39;SPTimerV4&#39;&#34;</span> <span class="n">-ComputerName</span> <span class="nv">$servername</span><span class="p">).</span><span class="n">stopservice</span><span class="p">()</span> <span class="p">|</span> <span class="nb">Out-Null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">foreach</span> <span class="p">(</span><span class="nv">$server</span> <span class="k">in</span> <span class="nv">$servers</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$servername</span> <span class="p">=</span> <span class="nv">$server</span><span class="p">.</span><span class="n">Address</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$folders</span> <span class="p">=</span> <span class="nb">Get-ChildItem</span> <span class="p">(</span><span class="s2">&#34;\\&#34;</span> <span class="p">+</span> <span class="nv">$servername</span> <span class="p">+</span> <span class="s2">&#34;\C$\ProgramData\Microsoft\SharePoint\Config&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$folder</span> <span class="k">in</span> <span class="nv">$folders</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$items</span> <span class="p">=</span> <span class="nb">Get-ChildItem</span> <span class="nv">$folder</span><span class="p">.</span><span class="n">FullName</span> <span class="n">-Recurse</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$item</span> <span class="k">in</span> <span class="nv">$items</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nv">$item</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">ToLower</span><span class="p">()</span> <span class="o">-eq</span> <span class="s2">&#34;cache.ini&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$cachefolder</span> <span class="p">=</span> <span class="nv">$folder</span><span class="p">.</span><span class="n">FullName</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">write-host</span> <span class="s2">&#34;Found CacheFolder on Server $servername = $cachefolder&#34;</span> <span class="o">-F</span> <span class="n">Yellow</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$cachefolderitems</span> <span class="p">=</span> <span class="nb">Get-ChildItem</span> <span class="nv">$cachefolder</span> <span class="n">-Recurse</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">write-host</span> <span class="s2">&#34;Delete all XMQL Files inside this CacheFolder&#34;</span> <span class="o">-F</span> <span class="n">Yellow</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$cachefolderitem</span> <span class="k">in</span> <span class="nv">$cachefolderitems</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$cachefolderitem</span> <span class="o">-like</span> <span class="s2">&#34;*.xml&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$cachefolderitem</span><span class="p">.</span><span class="n">Delete</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$a</span> <span class="p">=</span> <span class="nb">Get-Content</span> <span class="nv">$cachefolder</span><span class="p">\</span><span class="n">cache</span><span class="p">.</span><span class="n">ini</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$a</span> <span class="p">=</span> <span class="n">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">write-host</span> <span class="s2">&#34;Creating a new Cache.ini File on server $servername&#34;</span> <span class="o">-F</span> <span class="n">Yellow</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Set-Content</span> <span class="nv">$a</span> <span class="n">-Path</span> <span class="nv">$cachefolder</span><span class="p">\</span><span class="n">cache</span><span class="p">.</span><span class="n">ini</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">foreach</span> <span class="p">(</span><span class="nv">$server</span> <span class="k">in</span> <span class="nv">$servers</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$servername</span> <span class="p">=</span> <span class="nv">$server</span><span class="p">.</span><span class="n">Address</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">write-host</span> <span class="s2">&#34;START Timer Service on server $servername&#34;</span> <span class="o">-F</span> <span class="n">Yellow</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nb">Get-WmiObject</span> <span class="n">Win32_Service</span> <span class="n">-filter</span> <span class="s2">&#34;name=&#39;SPTimerV4&#39;&#34;</span> <span class="n">-ComputerName</span> <span class="nv">$servername</span><span class="p">).</span><span class="n">startservice</span><span class="p">()</span> <span class="p">|</span> <span class="nb">Out-Null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div>
        </div>
    </div>
</article>

        </main>
        <div class="feedback">
    <div class="container">
        <h4>Feedback</h4>
        <p>Submit feedback, ask questions, or just leave a comment by starting a
            <a target="_blank" href="https://github.com/login?return_to=https%3a%2f%2fgithub.com%2fjonthenerd%2fjonthenerd.github.io%2fdiscussions%2fnew%3ftitle%3d%26labels%3dblog-feedback%26body%3d%250A%250A%255BEnter%2520feedback%2520here%255D%250A%250A%250A---%250A%2523%2523%2523%2523%2520Post%2520Details%250A%250A%25E2%259A%25A0%2520%2aDo%2520not%2520edit%2520this%2520section.%2520It%2520helps%2520Jon%2520know%2520what%2520page%2520you%2520were%2520reading.%250A%250A%2a%2520Content%253A%2520%255BSharePoint%3a%20Search%20Managed%20Properties%20missing%20after%20full%20crawl%255D%28https%3a%2f%2fgithub.com%2fjonthenerd%2fjonthenerd.github.io%2ftree%2fmain%2fcontent%2fposts%2f2017-09-16-managed-props-and-config-cache.md%29%250A%2a%2520Post%253A%2520http%3a%2f%2fwww.jonthenerd.com%2f2017%2f09%2f16%2fmanaged-props-and-config-cache%2f">GitHub Discussion</a>.
        </p>
    </div>
</div>

        <footer>
    <div class="container">
        built with <a href="https://gohugo.io/">Hugo</a> and <a href="https://github.com/jonthenerd/jonthenerd.github.io">GitHub Pages</a> | <a href="/license">License</a>
    </div>
</footer>

    </body>
</html>
