<!doctype html><html lang=en>
<head prefix="og: http://ogp.me/ns#">
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Jon Badgett's personal blog. Open source projects, observations on life, and other oddities I find interesting.">
<title>SharePoint WebPart implementing ICallbackEventHandler does not work properly in Web Part Gallery &ndash; JonTheNerd</title>
<meta name=color-scheme content="dark light">
<script>window.matchMedia("(prefers-color-scheme: dark)").media==="not all"&&(document.documentElement.style.display="none",document.head.insertAdjacentHTML("beforeend",'<link rel="stylesheet" href="/assets/light.css" onload="document.documentElement.style.display = \'\'">'))</script>
<link rel=stylesheet media="(prefers-color-scheme: light)" href=/assets/light.css>
<link rel=stylesheet media="(prefers-color-scheme: dark)" href=/assets/dark.css>
<link rel=stylesheet href=/assets/style.css>
</head>
<body>
<header class=site-header>
<div class=container>
<h1>
<a href=/>JonTheNerd</a>
</h1>
<nav>
<ul>
<li><a href=/about>About</a></li>
</ul>
</nav>
</div>
</header>
<main>
<article class=single itemscope itemtype=http://schema.org/BlogPosting>
<header>
<h1 itemprop="name headline">
<div class=container>SharePoint WebPart implementing ICallbackEventHandler does not work properly in Web Part Gallery</div>
</h1>
<div class=post-meta>
<div class=container>
By Jon Badgett
| <time datetime=" 2010-12-07" itemprop=datePublished>December 7, 2010</time>
| Posted in
<a href=/categories/programming>Programming</a>, <a href=/categories/sharepoint>SharePoint</a>
</div>
</div>
</header>
<div itemprop=articleBody>
<div class=container>
<p>In migrating some WebParts from SP2007 to SP2010, I came across a webpart that
implements ICallbackEventHandler. This webpart was working fine when placed on
the page, but did not work correctly in the webpart gallery. The specific error
message being received was &ldquo;The target &lsquo;ctl00$PlaceHolderMain$ctl00&rsquo;Â for the
callback could not be found or did not implement ICallbackEventHandler&rdquo;. This
error is due to the webpart being added to the preview page dynamically at
runtime. Everything online I&rsquo;ve seen assumes that pages doing this can be
modified to load controls dynamically either in the Init event or on each Load
event. Since SharePoint developers can&rsquo;t affect the Web Part preview page - the
best I could come up with is to prevent the registratration for callback by
checking the ID of the control in the Load event. This will tell you if the
control is being loaded dynamically, or if it has been placed on a page.</p>
<p>Here&rsquo;s the code to use in the OnLoad event: [sourcecode language=&ldquo;csharp&rdquo;] if
(this.ID == null) { // This occurs in the webpart gallery and causes it to throw
a javascript error. Controls.Add(new LiteralControl("This webpart does not
function correctly in the webpart gallery. Please test on a page within a
webpart zone.")); } else { // Do what you normally do. } [/sourcecode]</p>
<p>Have a better idea on how to get this to work in the web part preview page? Let
me know. At this point I&rsquo;m content not throwing the javascript error.</p>
</div>
</div>
</article>
</main>
<div class=feedback>
<div class=container>
<h3>Feedback</h3>
<p>Submit feedback, ask questions, or just leave a comment with a
<a href="https://github.com/jonthenerd/jonthenerd.github.io/issues/new?title=&assignee=jonthenerd&labels=blog-feedback&body=%0A%0A%5BEnter%20feedback%20here%5D%0A%0A%0A---%0A%23%23%23%23%20Post%20Details%0A%0A%E2%9A%A0%20*Do%20not%20edit%20this%20section.%20It%20helps%20Jon%20know%20what%20page%20you%20were%20reading.%0A%0A*%20Content%3A%20%5BSharePoint%20WebPart%20implementing%20ICallbackEventHandler%20does%20not%20work%20properly%20in%20Web%20Part%20Gallery%5D(https%3a%2f%2fgithub.com%2fjonthenerd%2fjonthenerd.github.io/master/_posts%2f2010-12-07-sharepoint-webpart-implementing-icallbackeventhandler-does-not-work-properly-in-web-part-gallery.md)%0A*%20Post%20URL%3A%20http%3a%2f%2fwww.jonthenerd.com%2f2010%2f12%2f07%2fsharepoint-webpart-implementing-icallbackeventhandler-does-not-work-properly-in-web-part-gallery%2f">GitHub Issue</a></p>
</div>
</div>
something something
<footer>
<div class=container>
built with <a href=https://gohugo.io/>Hugo</a> and <a href=https://github.com/jonthenerd/jonthenerd.github.io>GitHub Pages</a> | <a href=/license>License</a>
</div>
</footer>
</body>
</html>