<!DOCTYPE html>
<html lang="en">
    <head prefix="og: http://ogp.me/ns#">
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="HandheldFriendly" content="True" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="description" content="Jon Badgett's personal blog. Open source projects, observations on life, and other oddities I find interesting." />
        <title>SharePoint WebPart implementing ICallbackEventHandler does not work properly in Web Part Gallery &ndash; JonTheNerd</title>
        <meta name="color-scheme" content="dark light" />
        <script>
            
            if (window.matchMedia("(prefers-color-scheme: dark)").media ==="not all") {
                document.documentElement.style.display = "none";
                document.head.insertAdjacentHTML(
                    "beforeend",
                    '<link rel="stylesheet" href="/assets/light.css" onload="document.documentElement.style.display = \'\'">'
                );
            }
        </script>
        <link rel="stylesheet" media="(prefers-color-scheme: light)" href="/assets/light.css" />
        <link rel="stylesheet" media="(prefers-color-scheme: dark)" href="/assets/dark.css" />
        <link rel="stylesheet" href="/assets/style.css" />
        
        <script src="/assets/scripts/main.js" defer></script>
        <link rel="canonical" href="http://www.jonthenerd.com/2010/12/07/sharepoint-webpart-implementing-icallbackeventhandler-does-not-work-properly-in-web-part-gallery/">
    </head>
    <body>
        <header class="site-header">
    <h1>
        <a href="/">JonTheNerd</a>
    </h1>
    <nav>
        <ul>
            <li><a href="/about">About</a></li>
        </ul>
    </nav>
</header>

        <main>
            
<article class="single" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
        <h1 itemprop="name headline">
            <div class="container">SharePoint WebPart implementing ICallbackEventHandler does not work properly in Web Part Gallery</div>
        </h1>
        <div class="post-meta">
            <div class="container">
                <time datetime=" 2010-12-07" itemprop="datePublished">December 7, 2010</time>
                
                | Posted in
                <a
                    href="/categories/programming">Programming</a>
                
                
                | Tagged with
                <a
                    href="/tags/sharepoint">SharePoint</a>
                
            </div>
        </div>
    </header>
    <div itemprop="articleBody">
        <div class="container">
            <p>In migrating some WebParts from SP2007 to SP2010, I came across a webpart that
implements ICallbackEventHandler. This webpart was working fine when placed on
the page, but did not work correctly in the webpart gallery. The specific error
message being received was:</p>
<blockquote>
<blockquote>
<p>The target &lsquo;ctl00$PlaceHolderMain$ctl00&rsquo;Â for the
callback could not be found or did not implement ICallbackEventHandler</p>
</blockquote>
</blockquote>
<p>This error is due to the webpart being added to the preview page dynamically at
runtime. Everything online I&rsquo;ve seen assumes that pages doing this can be
modified to load controls dynamically either in the Init event or on each Load
event. Since SharePoint developers can&rsquo;t affect the Web Part preview page - the
best I could come up with is to prevent the registratration for callback by
checking the ID of the control in the Load event. This will tell you if the
control is being loaded dynamically, or if it has been placed on a page.</p>
<p>Here&rsquo;s the code to use in the OnLoad event:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">ID</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// This occurs in the webpart gallery and causes it to throw a javascript error.</span>
</span></span><span class="line"><span class="cl">    <span class="n">Controls</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">LiteralControl</span><span class="p">(</span><span class="s">&#34;This webpart does not function correctly in the webpart gallery. Please test on a page within a webpart zone.&#34;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Do what you normally do.</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Have a better idea on how to get this to work in the web part preview page? Let
me know. At this point I&rsquo;m content not throwing the javascript error.</p>

        </div>
    </div>
</article>

        </main>
        <div class="feedback">
    <div class="container">
        <div id="disqus_thread"></div>
    </div>
</div>
<script>
    var disqus_config = function () {
        this.page.url = "http:\/\/www.jonthenerd.com\/2010\/12\/07\/sharepoint-webpart-implementing-icallbackeventhandler-does-not-work-properly-in-web-part-gallery\/";  
    };
    (function () {
        var d = document, s = d.createElement('script');
        s.src = 'https://jonthenerd.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        s.setAttribute("defer", "defer");
        (d.head || d.body).appendChild(s);
    })();
</script>


        <footer>
    <div class="container">
        built with <a href="https://gohugo.io/">Hugo</a> and <a href="https://github.com/jonthenerd/jonthenerd.github.io">GitHub Pages</a> | <a href="/license">License</a> | <span id="theme-toggle" role="button"></span>
    </div>
</footer>

    </body>
</html>
