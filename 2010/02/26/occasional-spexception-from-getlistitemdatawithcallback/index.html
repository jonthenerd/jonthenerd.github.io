<!DOCTYPE html>
<html lang="en">
    <head prefix="og: http://ogp.me/ns#">
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="description" content="Jon Badgett's personal blog. Open source projects, observations on life, and other oddities I find interesting." />
        <title>Occasional SPException from GetListItemDataWithCallback &ndash; JonTheNerd</title>
        <meta name="color-scheme" content="dark light" />
        <script>
            if (window.matchMedia("(prefers-color-scheme: dark)").media ==="not all") {
                document.documentElement.style.display = "none";
                document.head.insertAdjacentHTML(
                    "beforeend",
                    '<link rel="stylesheet" href="/assets/light.css" onload="document.documentElement.style.display = \'\'">'
                );
            }
        </script>
        <link rel="stylesheet" media="(prefers-color-scheme: light)" href="/assets/light.css" />
        <link rel="stylesheet" media="(prefers-color-scheme: dark)" href="/assets/dark.css" />
        <link rel="stylesheet" href="/assets/style.css" />
        </head>
    <body>
        <header class="site-header">
    <div class="container">
        <h1>
            <a href="/">JonTheNerd</a>
        </h1>
        <nav>
            <ul>
                <li><a href="/about">About</a></li>
            </ul>
        </nav>
    </div>
</header>

        <main>
            
    <article class="single" itemscope itemtype="http://schema.org/BlogPosting">
        <header>
            <h1 itemprop="name headline">
                <div class="container">Occasional SPException from GetListItemDataWithCallback</div>
            </h1>
            <div class="post-meta">
                <div class="container">
                    By Jon Badgett
                    | <time
                        datetime=" 2010-02-26"
                        itemprop="datePublished"
                        >February 26, 2010</time
                    >
                    
                        | Posted in
                        <a href="/categories/sharepoint">SharePoint</a>

                    
                </div>
            </div>
        </header>
        <div itemprop="articleBody">
            <div class="container">
            <p>Wrote a new field control today (SharePoint) that queried a specific list in
another site collection based on the value of a field from the current list
item. This worked great each time I&rsquo;d test it out and add some additional
functionality. When I finished the control, I did a little harder testing by
hitting the refresh button in my browser over and over again. Randomly, my
control wouldn&rsquo;t render. Other times it would be fine. What&rsquo;s up with
that?<!-- raw HTML omitted --><!-- raw HTML omitted -->If you Google it enough, you&rsquo;ll find that this message
generally appears when your CAML is malformed. Well - I used an XmlWriter to
build my CAML query (that way my inserted value from the item would be escaped
properly for XML), so surely my CAML must be fine if it&rsquo;s working most times???
Right??? Nope. The XmlWriter by default puts in a processing instruction on the
first line:<!-- raw HTML omitted --><!-- raw HTML omitted -->&lt;xml version=&ldquo;1.0&rdquo; encoding=&ldquo;UTF-8&rdquo;
?&gt;<!-- raw HTML omitted --><!-- raw HTML omitted -->Remove this first line and the field controls render each time
without error. The specific error I was receiving
was:<!-- raw HTML omitted --><!-- raw HTML omitted -->Microsoft.SharePoint.SPException was
caught<!-- raw HTML omitted -->Message=&ldquo;Exception occurred. (Exception from HRESULT: 0x80020009
(DISP_E_EXCEPTION))&quot;<!-- raw HTML omitted -->Source=&ldquo;Microsoft.SharePoint&rdquo;<!-- raw HTML omitted -->ErrorCode=-2147352567<!-- raw HTML omitted -->StackTrace:<!-- raw HTML omitted -->at
Microsoft.SharePoint.Library.SPRequest.GetListItemDataWithCallback(String
bstrUrl, String bstrListName, String bstrViewName, String bstrViewXml,
SAFEARRAYFLAGS fSafeArrayFlags, ISP2DSafeArrayWriter pSACallback,
ISPDataCallback pPagingCallback, ISPDataCallback pSchemaCallback)</p>

            </div>
        </div>
    </article>

        </main>
        
    <div class="feedback">
        <div class="container">
            <h3>Feedback</h3>
            <p>Submit feedback, ask questions, or just leave a comment with a
                <a href="https://github.com/jonthenerd/jonthenerd.github.io/issues/new?title=&assignee=jonthenerd&labels=blog-feedback&body=%0A%0A%5BEnter%20feedback%20here%5D%0A%0A%0A---%0A%23%23%23%23%20Post%20Details%0A%0A%E2%9A%A0%20*Do%20not%20edit%20this%20section.%20It%20helps%20Jon%20know%20what%20page%20you%20were%20reading.%0A%0A*%20Content%3A%20%5BOccasional%20SPException%20from%20GetListItemDataWithCallback%5D(https%3a%2f%2fgithub.com%2fjonthenerd%2fjonthenerd.github.io/master/_posts%2f2010-02-26-occasional-spexception-from-getlistitemdatawithcallback.md)%0A*%20Post%20URL%3A%20http%3a%2f%2fwww.jonthenerd.com%2f2010%2f02%2f26%2foccasional-spexception-from-getlistitemdatawithcallback%2f">GitHub Issue</a></p>
        </div>
    </div>
something something

        <footer>
    <div class="container">
        built with <a href="https://gohugo.io/">Hugo</a> and <a href="https://github.com/jonthenerd/jonthenerd.github.io">GitHub Pages</a> | <a href="/license">License</a>
    </div>
</footer>

    </body>
</html>
