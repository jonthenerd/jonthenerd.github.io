<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>SharePoint 2010: Finding the largest document library in a site collection &ndash; JonTheNerd</title>
    </head>

<body>
    
    <nav>
    <a href="/">JonTheNerd</a>
    <ul>
        <li><a href="/about">About</a></li>
    </ul>
</nav>
    
<h1>SharePoint 2010: Finding the largest document library in a site collection</h1>
<p>SharePoint 2007 came with a page (storman.aspx) dedicated to showing you how
much space each of the lists in your site collection were taking up. SharePoint
2010 removed this page. Luckily, SharePoint 2010 SP1 added it back in. But what
if you&rsquo;re still haven&rsquo;t updated to SP1 and you&rsquo;re getting warnings/errors about
running out of space?</p>
<p>Obviously - up the space so as to avoid additional noise from your users. Then -
figure out which libraries are taking up the most space. This can be done by
using the (now obsolete - but working)
<!-- raw HTML omitted -->StorageManagementInformation
method off of SPSite<!-- raw HTML omitted -->. You can write some C# to use it, or you can use
PowerShell.</p>
<p>The required arguments for this method (listed below) can be found by looking at
the above MSDN link. I&rsquo;ll also include the potential values that can be found by
using Reflector to look at the Microsoft.SharePoint dll:</p>
<!-- raw HTML omitted -->
<p>So if you want to find the top 5 largest document libraries in a specific site
collection, here&rsquo;s the PowerShell: [code lang=&ldquo;ps&rdquo;]
$site = Get-SPSite &quot;http://yoursitecollection:portifneeded&quot;;
$dataTable
= $site.StorageManagementInformation(2,0x11,0,5);
$dataTable | Select * [/code]</p>
<p>This is very helpful if you aren&rsquo;t yet on SP2010 SP1. A note though - the method
is marked as obselete with this description &ldquo;SPSite.StorageManagementInformation
is expensive; avoid using it.&rdquo;. There&rsquo;s no further explanation on what is being
spooled up to execute the method or why it was OK in SP2007 but not SP2010. So
I&rsquo;d consider this OK to use if you have to&hellip;but not in some kind of recurring
scheduled script. Your mileage may vary, I&rsquo;m not responsible for what happens to
your farm, etc. etc.</p>
<p>Hope you found this useful. Let me know!</p>


    
    
    
</body>

</html>
