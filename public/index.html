<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>JonTheNerd</title>
    <link rel="alternate" type="application/rss+xml" href="http://www.jonthenerd.com/feed.xml" title="JonTheNerd" /></head>

<body>
    
    <nav>
    <a href="/">JonTheNerd</a>
    <ul>
        <li><a href="/about">About</a></li>
    </ul>
</nav>
    
<main aria-role="main">
    <header class="homepage-header">
        <h1>JonTheNerd</h1>
        
    </header>
    <div class="homepage-content">
        
        
    </div>
    <div>
        
        <article>
            <h2>Microsoft Flow: Using the SharePoint REST API</h2>
            <p>This post will contain whatever handy information I come across for utilizing
the SharePoint REST APIs with Microsoft Flow.</p>
<p>Why would you want to do this? Because there aren&rsquo;t enough actions to accomplish
all the things you&rsquo;d want to do with SharePoint via Flow.</p>
<p>The first section of this guide comes from combining a few different blog posts,
but I found
<a href="https://blogs.u2u.be/u2u/post/calling-the-sharepoint-online-api-from-within-microsoft-flow">Calling the SharePoint Online API from within Microsoft Flow by ROBRECHT-VAN-CAENEGEM</a>
to be the most useful. It&rsquo;s got pictures!</p>
<h1 id="how-does-this-work">How does this work?</h1>
<ul>
<li>Microsoft Flow can send generic HTTP requests, with custom headers, body, etc.</li>
<li>For Flow to authenticate to SharePoint during the REST calls, we&rsquo;ll make use
of the access tokens typically used for SharePoint Addins/Apps</li>
</ul>
<h1 id="intial-setup">Intial Setup</h1>
<p>We&rsquo;re going to need four pieces of data:</p>
<ul>
<li><strong>CLIENTID</strong>: Unique id assigned to your add-in registration</li>
<li><strong>CLIENTSECRET</strong>: Secret value used by your add-in registration</li>
<li><strong>REALM</strong>: This is the unique id assigned to your SharePoint Online tenant.</li>
<li><strong>TENANT</strong>: The hostname of your tenant (e.g. example.sharepoint.com)</li>
</ul>
<h2 id="obtain-the-clientid-and-clientsecret-values">Obtain the CLIENTID and CLIENTSECRET values</h2>
<ol>
<li>
<p>On the SharePoint site that you need to communicate with, navigate to
AppRegNew page</p>
<pre><code>&lt;your site's URL&gt;/_layouts/15/appregnew.aspx
</code></pre></li>
<li>
<p>Fill in the information.</p>
<ul>
<li>Client Id: &laquo;Generate It!&raquo;</li>
<li>Client Secret: &laquo;Generate It!&raquo;</li>
<li>Title: &laquo;Project Name Flow&raquo;</li>
<li>App Domain: localhost</li>
<li>Redirect URI: https:/localhost</li>
</ul>
</li>
<li>
<p>Store the Client Id and Secret. We&rsquo;re going to need it for the next step.</p>
</li>
<li>
<p>Click the <em>Create</em> button.</p>
</li>
<li>
<p>Navigate to the AppInv page</p>
<pre><code>&lt;your site's URL&gt;/_layouts/15/appinv.aspx
</code></pre></li>
<li>
<p>Put the <em>Client Id</em> into the <em>App Id</em> text box and look it up.</p>
</li>
<li>
<p>Paste the following XML into the <em>Permission Request XML</em> box
(<a href="https://docs.microsoft.com/en-us/sharepoint/dev/sp-add-ins/add-in-permissions-in-sharepoint">modify as needed for what scope and right you need</a>):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#f92672">&lt;AppPermissionRequests</span> <span style="color:#a6e22e">AllowAppOnlyPolicy=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;AppPermissionRequest</span> <span style="color:#a6e22e">Scope=</span><span style="color:#e6db74">&#34;http://sharepoint/content/sitecollection&#34;</span> <span style="color:#a6e22e">Right=</span><span style="color:#e6db74">&#34;FullControl&#34;</span> <span style="color:#f92672">/&gt;</span>
<span style="color:#f92672">&lt;/AppPermissionRequests&gt;</span>
</code></pre></div></li>
<li>
<p>Click the <em>Create</em> button.</p>
</li>
</ol>
<h2 id="obtain-the-realm-value">Obtain the REALM value</h2>
<ol>
<li>On the SharePoint site that you just finished app registration on, navigate
to the AppPrincipals page
<pre><code>/_layouts/15/AppPrincipals.aspx
</code></pre></li>
<li>You should see your recently registered app principle along with an App
Identifier. The last section of the App Identifier, after the @, is the
REALM value.</li>
</ol>
<h2 id="setup-authentication-in-flow">Setup Authentication in Flow</h2>
<ol>
<li>
<p>In your created flow, directly after the trigger, do the following:</p>
</li>
<li>
<p>Create a new <strong>Parse JSON</strong> action, renamed to <em>Authentication Values</em>,
filling in your own values and using the below schema.</p>
<ul>
<li>Content:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#f92672">&#34;realm&#34;</span>: <span style="color:#e6db74">&#34;{REALM}&#34;</span>,
  <span style="color:#f92672">&#34;clientId&#34;</span>: <span style="color:#e6db74">&#34;{CLIENTID}&#34;</span>,
  <span style="color:#f92672">&#34;clientSecret&#34;</span>: <span style="color:#e6db74">&#34;{CLIENTSECRET}&#34;</span>,
  <span style="color:#f92672">&#34;principal&#34;</span>: <span style="color:#e6db74">&#34;00000003-0000-0ff1-ce00-000000000000&#34;</span>,
  <span style="color:#f92672">&#34;tenant&#34;</span>: <span style="color:#e6db74">&#34;{TENANT}&#34;</span>
}
</code></pre></div></li>
<li>Schema:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;object&#34;</span>,
  <span style="color:#f92672">&#34;properties&#34;</span>: {
    <span style="color:#f92672">&#34;realm&#34;</span>: { <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;string&#34;</span> },
    <span style="color:#f92672">&#34;clientId&#34;</span>: { <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;string&#34;</span> },
    <span style="color:#f92672">&#34;clientSecret&#34;</span>: { <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;string&#34;</span> },
    <span style="color:#f92672">&#34;principal&#34;</span>: { <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;string&#34;</span> },
    <span style="color:#f92672">&#34;tenant&#34;</span>: { <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;string&#34;</span> }
  }
}
</code></pre></div></li>
</ul>
</li>
<li>
<p>Create a new <strong>Initialize variable</strong> action, renamed to Initialize
AccessTokenBody, with the following values: - Name: <code>AccessTokenBody</code> -
Type: String - Value:
<code>concat('grant_type=client_credentials&amp;client_id=', body('Authentication_Values')?['clientId'], '@', body('Authentication_Values')?['realm'], '&amp;client_secret=', body('Authentication_Values')?['clientSecret'], '&amp;resource=', body('Authentication_Values')?['principal'], '/', body('Authentication_Values')?['tenant'], '@', body('Authentication_Values')?['realm']) </code></p>
</li>
<li>
<p>Create a new <strong>HTTP - HTTP</strong> action.</p>
</li>
<li>
<p>Rename it <em>Get Access Token</em></p>
</li>
<li>
<p>Fill in the values:</p>
<ul>
<li><strong>Method</strong>: POST</li>
<li><strong>Uri</strong>:
<code>https://accounts.accesscontrol.windows.net/@{body('Authentication_Values')?['realm']}/tokens/oauth/2</code></li>
<li><strong>Headers</strong>:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#f92672">&#34;Content-Type&#34;</span>: <span style="color:#e6db74">&#34;application/x-www-form-urlencoded&#34;</span>
}
</code></pre></div></li>
<li><strong>Body</strong>: the <em>AccessTokenBody</em> variable</li>
</ul>
</li>
<li>
<p>Add a new <strong>Parse JSON</strong> action and rename it <strong>Parse Access Token</strong>.</p>
</li>
<li>
<p>Content should be set to the Body parameter from the previuos step. Schema
should be set to the following:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;object&#34;</span>,
  <span style="color:#f92672">&#34;properties&#34;</span>: {
    <span style="color:#f92672">&#34;token_type&#34;</span>: { <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;string&#34;</span> },
    <span style="color:#f92672">&#34;access_token&#34;</span>: { <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;string&#34;</span> }
  }
}
</code></pre></div></li>
</ol>
<p>With this setup, you should be able to test your FLOW and not have it error. You
can also check and see the token_type and access_token being parsed. Note that
the most tricky part of this is getting the Body variable of step 6 setup
correctly. Note that my value depends upon you having renamed the steps as I
instructed to work.</p>
<p><strong>You&rsquo;re now ready to start using SharePoint REST APIs in Flow!</strong></p>
<h1 id="helpful-snippets">Helpful Snippets</h1>
<p>This section will be a hodge podge of useful snippets I plan to continue adding
to.</p>
<h2 id="general">General</h2>
<h3 id="headers">Headers</h3>
<p>It&rsquo;s easiest to paste in the headers values of <strong>HTTP - HTTP</strong> actions if it&rsquo;s
in text mode. Here&rsquo;s what&rsquo;s needed (adjust the name of the action where mine
says <strong>Parse Access Token</strong> to match the name of your action that parses the
access tokens)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#f92672">&#34;Authorization&#34;</span>: <span style="color:#e6db74">&#34;@{body(&#39;Parse Access Token&#39;)?[&#39;token_type&#39;]} @{body(&#39;Parse Access Token&#39;)?[&#39;access_token&#39;]}&#34;</span>,
  <span style="color:#f92672">&#34;Accept&#34;</span>: <span style="color:#e6db74">&#34;application/json;odata=verbose&#34;</span>,
  <span style="color:#f92672">&#34;Content-Type&#34;</span>: <span style="color:#e6db74">&#34;application/json;odata=verbose&#34;</span>
}
</code></pre></div><h2 id="groups-and-permissions">Groups and Permissions</h2>
<h3 id="set-the-owner-of-a-sharepoint-group-to-another-sharepoint-group">Set the Owner of a SharePoint Group to another SharePoint Group</h3>
<p>So, this apparently has been broken via typical REST API method calls for quite
some time. There is a working alternative though - manually construct the call
that the CSOM library would have made. The best resource I found for this is
<a href="http://www.jrjlee.com/2014/01/custom-workflow-activity-for-setting.html">Jason Lee&rsquo;s blog post: Custom Workflow Activity for Setting a SharePoint Group Owner</a>,
which is specifically talking about doing this within a SharePoint 2013 model
workflow. We&rsquo;ll modify it slightly.</p>
<ol>
<li>Start with your standard <strong>HTTP - HTTP</strong> action.</li>
<li>Method = POST</li>
<li>Uri (adjust values for your environment) =
<code>https://{TENANT}/{SPSITE_URL}/_vti_bin/client.svc/ProcessQuery</code></li>
<li>Headers are slightly different than the Headers helpful snippet.
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#f92672">&#34;Authorization&#34;</span>: <span style="color:#e6db74">&#34;@{body(&#39;Parse Access Token&#39;)?[&#39;token_type&#39;]} @{body(&#39;Parse Access Token&#39;)?[&#39;access_token&#39;]}&#34;</span>,
  <span style="color:#f92672">&#34;Accept&#34;</span>: <span style="color:#e6db74">&#34;application/json;odata=verbose&#34;</span>,
  <span style="color:#f92672">&#34;Content-Type&#34;</span>: <span style="color:#e6db74">&#34;text/xml&#34;</span>
}
</code></pre></div></li>
<li>Body gets fun. You&rsquo;ve got a few values to substitute.
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#f92672">&lt;Request</span> <span style="color:#a6e22e">AddExpandoFieldTypeSuffix=</span><span style="color:#e6db74">&#34;true&#34;</span> <span style="color:#a6e22e">SchemaVersion=</span><span style="color:#e6db74">&#34;15.0.0.0&#34;</span> <span style="color:#a6e22e">LibraryVersion=</span><span style="color:#e6db74">&#34;15.0.0.0&#34;</span> <span style="color:#a6e22e">ApplicationName=</span><span style="color:#e6db74">&#34;{YOUR_APP}&#34;</span> <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://schemas.microsoft.com/sharepoint/clientquery/2009&#34;</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;Actions&gt;</span>
        <span style="color:#f92672">&lt;SetProperty</span> <span style="color:#a6e22e">Id=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#a6e22e">ObjectPathId=</span><span style="color:#e6db74">&#34;2&#34;</span> <span style="color:#a6e22e">Name=</span><span style="color:#e6db74">&#34;Owner&#34;</span><span style="color:#f92672">&gt;</span>
            <span style="color:#f92672">&lt;Parameter</span> <span style="color:#a6e22e">ObjectPathId=</span><span style="color:#e6db74">&#34;3&#34;</span> <span style="color:#f92672">/&gt;</span>
        <span style="color:#f92672">&lt;/SetProperty&gt;</span>
        <span style="color:#f92672">&lt;Method</span> <span style="color:#a6e22e">Name=</span><span style="color:#e6db74">&#34;Update&#34;</span> <span style="color:#a6e22e">Id=</span><span style="color:#e6db74">&#34;4&#34;</span> <span style="color:#a6e22e">ObjectPathId=</span><span style="color:#e6db74">&#34;2&#34;</span> <span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;/Actions&gt;</span>
    <span style="color:#f92672">&lt;ObjectPaths&gt;</span>
        <span style="color:#f92672">&lt;Identity</span> <span style="color:#a6e22e">Id=</span><span style="color:#e6db74">&#34;2&#34;</span> <span style="color:#a6e22e">Name=</span><span style="color:#e6db74">&#34;740c6a0b-85e2-48a0-a494-e0f1759d4aa7:site:{SPSITE_ID}:g:{TARGET_GROUP_ID}&#34;</span> <span style="color:#f92672">/&gt;</span>
        <span style="color:#f92672">&lt;Identity</span> <span style="color:#a6e22e">Id=</span><span style="color:#e6db74">&#34;3&#34;</span> <span style="color:#a6e22e">Name=</span><span style="color:#e6db74">&#34;740c6a0b-85e2-48a0-a494-e0f1759d4aa7:site:{SPSITE_ID}:g:{NEW_OWNER_GROUP_ID}&#34;</span> <span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;/ObjectPaths&gt;</span>
<span style="color:#f92672">&lt;/Request&gt;</span>
</code></pre></div><ul>
<li>YOUR_APP = Identity your app. This isn&rsquo;t really that important.</li>
<li>SPSITE_ID = this is the GUID of the site collection you&rsquo;re working with.
Don&rsquo;t include the curly braces.</li>
<li>TARGET_GROUP_ID = this is the integer of the group that needs an ownership
change</li>
<li>NEW_OWNER_GROUP_ID = this is the integer of the group that will be the
owner</li>
</ul>
</li>
</ol>
<h2 id="schemas">Schemas</h2>
<p>These are some helpful schemas to paste in to get values back from REST calls.</p>
<h3 id="get-role-definition-or-group-id">Get Role Definition or Group Id</h3>
<ul>
<li>Example URLs:
<pre><code>https://{TENANT}/{SPSITE_URL}/_api/web/roledefinitions/getbyname('Contribute')/id
https://{TENANT}/{SPSITE_URL}/_api/web/sitegroups/getbyname('Some%20Group')/id
</code></pre></li>
<li>Schema:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;object&#34;</span>,
  <span style="color:#f92672">&#34;properties&#34;</span>: {
    <span style="color:#f92672">&#34;d&#34;</span>: {
      <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;object&#34;</span>,
      <span style="color:#f92672">&#34;properties&#34;</span>: {
        <span style="color:#f92672">&#34;Id&#34;</span>: { <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;number&#34;</span> }
      }
    }
  }
}
</code></pre></div></li>
</ul>
<h3 id="get-list-or-library-id">Get List or Library Id</h3>
<ul>
<li>Schema:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;object&#34;</span>,
  <span style="color:#f92672">&#34;properties&#34;</span>: {
    <span style="color:#f92672">&#34;d&#34;</span>: {
      <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;object&#34;</span>,
      <span style="color:#f92672">&#34;properties&#34;</span>: {
        <span style="color:#f92672">&#34;Id&#34;</span>: { <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;string&#34;</span> }
      }
    }
  }
}
</code></pre></div></li>
</ul>
        </article>
        
        <article>
            <h2>SharePoint Framework: Extensions - Application Customizer</h2>
            <p>Next in this series on the SharePoint Framework are extensions.
<a href="https://docs.microsoft.com/en-us/sharepoint/dev/spfx/extensions/overview-extensions">According to docs.microsoft.com, SPFx Extensions allow for the customization of multiple facets of the SharePoint experience</a>.
I&rsquo;ll focus on differences I made while following the online tutorial and my
observations on capabilities and impacts of SPFx Application Customizer
extensions.</p>
<p>The best way to get started learning about these types of SharePoint
customization is to read the relevant docs.mocrosoft.com documentation:</p>
<ul>
<li><a href="https://docs.microsoft.com/en-us/sharepoint/dev/spfx/extensions/overview-extensions">Overview of SharePoint Framework Extensions</a></li>
<li><a href="https://docs.microsoft.com/en-us/sharepoint/dev/spfx/extensions/get-started/build-a-hello-world-extension">Build your first SharePoint Framework Extension (Hello World part 1)</a></li>
</ul>
<p>For the most part, the above instructions work just fine. However, there are a
couple modifications that I made:</p>
<ul>
<li>
<p>Use <a href="https://github.com/creationix/nvm">Node Version Manager</a> to ensure that
you&rsquo;re using the supported version of node and npm that go with the SharePoint
Framework (node 6.11.5 at the time of this writing).
<a href="/2018/01/16/configuring-nvm-for-osx">Here&rsquo;s a post I wrote on how to set it up on MacOS</a>.
This will avoid HTTP2/SSL issues when launching the workbench.</p>
</li>
<li>
<p>Modify the package.json scripts to include the necessary gulp commands such
that you don&rsquo;t have to have gulp installed globally. Here&rsquo;s what that section
should look like:</p>
<pre><code>```json
&quot;scripts&quot;: {
    &quot;build&quot;: &quot;gulp bundle&quot;,
    &quot;clean&quot;: &quot;gulp clean&quot;,
    &quot;test&quot;: &quot;gulp test&quot;,
    &quot;bundle&quot;: &quot;gulp bundle&quot;,
    &quot;bundle:ship&quot;: &quot;gulp bundle --ship&quot;,
    &quot;package&quot;: &quot;gulp package-solution&quot;,
    &quot;package:ship&quot;: &quot;gulp package-solution --ship&quot;,
    &quot;trust-dev-cert&quot;: &quot;gulp trust-dev-cert&quot;,
    &quot;serve:nobrowser&quot;: &quot;gulp serve --nobrowser&quot;
},
```
</code></pre>
<p>You&rsquo;ll then run the gulp commands listed in the tutorial using npm run
&lt;scriptname&gt; :</p>
<pre><code>```shell
npm run trust-dev-cert		# To trust the dev cert
npm run serve:nobrowser		# To start hosting the extension without launching workbench
```
</code></pre>
</li>
</ul>
<h2 id="observations-on-application-customizer-extensions">Observations on Application Customizer Extensions</h2>
<p>Working through the online tutorials, I had a number of items I wanted
clarification on that aren&rsquo;t spelled out in the documentation that I&rsquo;ve run
across. Here are my notes.</p>
<h3 id="which-placeholders-are-available">Which placeholders are available?</h3>
<p>At the time of this wring, Top and Bottom.</p>
<h3 id="how-do-these-different-placeholder-areas-appear-and-function-in-desktop-web-browsers-mobile-web-browsers-and-the-sharepoint-mobile-app">How do these different placeholder areas appear and function in desktop web browsers, mobile web browsers, and the SharePoint mobile app?</h3>
<ul>
<li><strong>On a desktop web browser</strong>, these appear directly underneath the app
launcher (and above the site icon) and attached to the bottom of the browser
window (the main site area is then placed within a div that has a vertical
scrollbar).</li>
<li><strong>On a mobile web browser</strong>, placement is the same as the desktop web browser.
However, the behavior when scrolling is different. When scrolling down the
page, the top placeholder content as well as the site title/global nav area
scroll with the page and are removed from view. However, the content of the
bottom placeholder is <em>always visible</em>.</li>
<li><strong>On the SharePoint mobile app (IOS tested, v3.7.0)</strong> The good news? the
content of the top and bottom placeholder make an appearance. Now here&rsquo;s
what&rsquo;s not so great:
<ul>
<li>The placement of the content within the Top placeholder is different. It now
appears beneath the site title / global navigation area.</li>
<li>The bottom placeholder is not initially visible when loading a site within
the app. After scrolling down a bit, the content of the bottom placeholder
appears.</li>
<li>The SharePoint app doesn&rsquo;t load the necessary css to alow the ms- classes to
work (like ms-bgColor-themeDark ms-fontColor-white used in the HelloWorld
Demo). This causes the background of the HelloWorld extension to appear
transparent. I added hard coded background-color and color style values and
these appeared fine in the application.</li>
<li>At least with the code used from the tutorial, the customizations only
appeared for me on initial load of the application and site. If I browsed to
something else and then came back to app, the content of the top and bottom
placeholders was not present. I&rsquo;m hopeful that this is just a bug with the
HelloWorld code.
<a href="https://github.com/SharePoint/sp-dev-docs/issues/1069">Issue #1069, SPFx Application Customizer, placeholder not re-rendering on page load</a>
looks like it could be related, but the advised fix didn&rsquo;t address the issue
within the app. Either there&rsquo;s something missing that&rsquo;s needed to keep it
working, or there is a bug with the mobile app.</li>
</ul>
</li>
</ul>
<h3 id="how-do-the-above-observations-affect-the-buildout-of-a-modern-intranet-on-o365">How do the above observations affect the buildout of a modern intranet on O365?</h3>
<h4 id="_on-global-navigation_"><em>On Global Navigation</em></h4>
<p>There is sample code available for creating an aplication customizer extension
to add a mega menu at the top of pages. The thought being that you could deploy
this customization to all of the sites you wanted to be a part of your intranet
portal and you&rsquo;d have consistent navigation.</p>
<p>If you&rsquo;re going to be using the SharePoint mobile app, and the above noted
disappearing act has been fixed in either the sample code or the mobile app, the
placement of the top element placeholder is different than that in mobile or
desktop web browsers, which could cause confusion for users. <strong>As such, if usage
of the SharePoint mobile app is desired, think critically about how the
navigation would be displayed to end users in the app / web browsers to ensure
it&rsquo;s not confusing. If you can&rsquo;t do this, avoid putting a menu here.</strong></p>
<p>What I&rsquo;d advise doing as an alternative to this involves Hub Sites (which aren&rsquo;t
released yet). They purport to allow for the establishment of consistent global
navigation for all sites joined to the hub. You&rsquo;d then use the left (current)
navigation for within-site navigation purposes.</p>
<h4 id="_on-consistent-footers_"><em>On Consistent Footers</em></h4>
<p>In my mind, the bottom placeholder area has been where I wanted to put
consistent footer information (a company logo, contact information for the
page/site, social media links, etc.). This kind of thing tends to take up a
decent amount of vertical space, which is ok because the user has to scroll to
the bottom to see it anyway. It&rsquo;s not in the way.</p>
<p>With the current implementation though, significant caution is warranted. Would
you want half of the screen real-estate occupied with the same footer
information? No. As a user, I&rsquo;d find it annoying if anything was attached to the
bottom of my screen blocking valuable reading space, particularly if it appears
page after page, throughout my entire usage of a site/app. <strong>Advice - don&rsquo;t use
the bottom placeholder to load your consistent footer.</strong></p>
<p>What&rsquo;s the alternative? Think of the places in your Intranet portal that
<em>really</em> need a footer. You&rsquo;ve got the main landing page and probably another
handful of pages that see really high traffic. Outside of this, if you have some
logic to display contact info for a given page, you might want that on
additional pages but probably also want the ability for the information not to
be shown if a page author opts out. So - build 1 or 2 SPFx WebParts for footer
usage. One would be your <em>big footer</em> for your main landing page. The second
you&rsquo;d advise page authors use so they can show page contact information. If they
want the info, they&rsquo;ll add the WebPart. If they want to opt out, they&rsquo;ll omit
it.</p>
<h4 id="_what-do-we-use-these-placeholders-for-anyway_"><em>What do we use these Placeholders for anyway?!</em></h4>
<p>I think the big usage of the placeholders is for context-sensitive
notifications, <em>not branding</em>.</p>
<p>Let&rsquo;s take our page footer example above. You could present a notification to a
page author (while they&rsquo;re authoring) advising them to add the footer WebPart
(and allow them to dismiss the notification until their next browser session or
something).</p>
<p>Obviously, there are plenty of usages for notifications&hellip;</p>
<p>In order to leverage O365 and avoid over-customization that causes upgrade <em>fun</em>
down the road, it requires stepping back from our typical approaches (like
adding mega menus and footers) and thinking about (1) what are we trying to have
the user see or do, (2) when this is really necessary and when it&rsquo;s not, and (3)
how do we guide them to see the items or take the actions we want in the most
supported fashion. In this way we&rsquo;ll minimize our development costs, maximize
our investment in the O365/SharePoint platform, and focus more on extracting
business value than simply re-implementing the same old thing atop the latest
SharePoint release.</p>
        </article>
        
        <article>
            <h2>Configuring Node Version Manager (NVM) for OS X</h2>
            <p>So, you have multiple projects and one or more of them have dependencies (or
just plain don&rsquo;t work) on certain versions of node? What to do?
<a href="https://github.com/creationix/nvm">Node Version Manager (NVM) allows you to install and switch between them &ldquo;with ease&rdquo;</a>
(quotes added as I&rsquo;m writing this blog post as I get it installed for the first
time myself&hellip; lets see just how easy it is!).</p>
<h2 id="before-you-install---uninstall-node">Before You Install - Uninstall Node!</h2>
<p>Although it&rsquo;s optional to remove previous node installations, it&rsquo;s recommended.
There&rsquo;s a
<a href="https://stackoverflow.com/questions/11177954/how-do-i-completely-uninstall-node-js-and-reinstall-from-beginning-mac-os-x">great post on Stack Overflow that describes how to remove nodejs manually and for this that used brew to originally install node</a>.</p>
<h2 id="ensure-you-have-the-xcode-command-line-tools">Ensure you have the Xcode command line tools.</h2>
<p>The Xcode command line tools (which you may already have for other reasons) are
required. The easiest way to install them is to run the following in the
terminal:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">xcode-select --install
</code></pre></div><h2 id="run-the-nvm-install-script">Run the NVM Install Script</h2>
<p>You can either use cURL or Wget to install NVM. To test if you have either, just
type curl or wget into a terminal window and hit return. If you get some kind of
response that isn&rsquo;t an error, you know which to use. Otherwise, you can install
wget via brew:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">brew install wget
</code></pre></div><p>Then you&rsquo;ll want to run the latest install script mentioned on the
<a href="https://github.com/creationix/nvm">NVM repo</a>. <strong>Go there and copy+paste into
your terminal window</strong>.</p>
<p>After it installs, you ought to be able to open a fresh terminal window and type
in <strong>nvm</strong> and see some kind of output, but not this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ nvm
-bash: nvm: command not found
</code></pre></div><p>If you got that, it means that your shell isn&rsquo;t configured to use nvm. What I
found after investigating is that NVM had added references to itself to the
.bashrc file directly in my home directory. You can see this by typing the
following in a terminal:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">open $HOME/.bashrc
</code></pre></div><p>However, it hadn&rsquo;t added itself to the .bash_profile file.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">open $HOME/.bash_profile
</code></pre></div><p>A kind user on Stack Exchange explains that
<a href="https://apple.stackexchange.com/questions/51036/what-is-the-difference-between-bash-profile-and-bashrc">on OS X, every time terminal is run it considers it a <em>login terminal</em> which uses the .bash_profile file and not the .bashrc file</a>.
An easy fix for this though is to just consolidate all of the customizations to
the terminal load process into the .bashrc file.</p>
<p>Add the following to your .bash_profile and move its contents into .bashrc.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -f $HOME/.bashrc <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
        source $HOME/.bashrc
<span style="color:#66d9ef">fi</span>
</code></pre></div><p>Fire up a fresh terminal and run the following, which should output <strong>nvm</strong> if
the install was successful.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">command -v nvm
</code></pre></div><h2 id="install-node-versions">Install Node Versions</h2>
<p>We&rsquo;ve got NVM, now let&rsquo;s install the versions of node we want to use across
ourprojects.</p>
<h4 id="latest-node">Latest node</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">nvm install node
</code></pre></div><h4 id="specific-version-of-node">Specific version of Node</h4>
<p><a href="https://docs.microsoft.com/en-us/sharepoint/dev/spfx/set-up-your-development-environment">Version 6.11.5 of node.js is required for SharePoint Framework development</a>
as of this writing.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">nvm install 6.11.5
</code></pre></div><p>Note that you can list all available installed node versions using the following
commandline:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">nvm ls
</code></pre></div><h2 id="configure-your-project-to-use-a-specific-version">Configure your project to use a specific version</h2>
<p>For this, we&rsquo;re going to place a .nvmrc into the root of each project that
utilizes node which indicates which version to use.</p>
<ol>
<li>
<p>Get to the target directory</p>
</li>
<li>
<p>Run one of the following:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">echo <span style="color:#e6db74">&#34;5.9&#34;</span> &gt; .nvmrc

echo <span style="color:#e6db74">&#34;lts/*&#34;</span> &gt; .nvmrc <span style="color:#75715e"># to default to the latest LTS version</span>

echo <span style="color:#e6db74">&#34;node&#34;</span> &gt; .nvmrc <span style="color:#75715e"># to default to the latest version</span>
</code></pre></div></li>
<li>
<p>Start using that node version using the following command:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">nvm use
</code></pre></div></li>
<li>
<p>(optional) You can configure auto-switching to the desired node version
instead of having to type nvm use. This requires using
<a href="https://github.com/wbyoung/avn">AVN (Automatic Version Switching for Node)</a>
which works in conjunction with the .nvmrc file.</p>
</li>
</ol>
        </article>
        
        <article>
            <h2>SharePoint Framework: Getting Started</h2>
            <p>Today I decided that it was time I learned how to build
<a href="https://docs.microsoft.com/en-us/sharepoint/dev/spfx/sharepoint-framework-overview">SharePoint Framework (SPFx)</a>
webparts. Easy enough right? Find the right tutorial online, follow
instrucitons, hello world! Let&rsquo;s get started.</p>
<p>First, you&rsquo;ll need to
<a href="https://docs.microsoft.com/en-us/sharepoint/dev/spfx/set-up-your-development-environment">set up your SharePoint Framework development environment</a>.
Then you&rsquo;ll want to follow the tutorial to
<a href="https://docs.microsoft.com/en-us/sharepoint/dev/spfx/web-parts/get-started/build-a-hello-world-web-part">build your first web part</a>.</p>
<p>Of course, this all depends upon you having
<a href="https://nodejs.org/en/">node js w/npm</a> installed and your code editor of choice
ready to go.</p>
<p>Seeing as I had the latest version of node and a code editor ready, I just
started at the tutorials. Quickly ran into an issue though, where neither Safari
or Chrome were able to connect to the workbench site running on localhost.
Here&rsquo;s the exact error from Safari:</p>
<blockquote>
<p>Safari can&rsquo;t open the page &ldquo;https://localhost:4321/temp/workbench.html&rdquo;
because Safari can&rsquo;t establish a secure connection to the server &ldquo;localhost&rdquo;.</p>
</blockquote>
<p><a href="https://github.com/SharePoint/sp-dev-docs/issues/1002">Issue #1002 on the sp-dev-docs repo</a>
seems to describe what&rsquo;s occurring here but no amount of setting the environment
variable NODE_NO_HTTP2=1 would help me get past the error message.</p>
<p>Reading back through
<a href="https://docs.microsoft.com/en-us/sharepoint/dev/spfx/set-up-your-development-environment">how to setup your SharePoint Framework development environment</a>,
there is a note that says:</p>
<blockquote>
<p>The SharePoint Framework build pipeline doesn&rsquo;t currently support the LTS
version of Node.js. Instead, download Node.js version 6.11.5. This installs
npm 3.10.10. Note that if you have a v5.x version of npm, you need to
downgrade to an older npm version by using the following command: npm install
-g npm@3.</p>
</blockquote>
<p>A couple observations on this, as I&rsquo;m writing this blog post as I try to get
this all working:</p>
<ul>
<li>Embracing the open source ecosystem and modern development tooling is great.
Requiring that in order to use your framework you must be running a version of
node.js that is 3 major versions behind current (9.4.0) and 2 major versions
behind LTS (8.9.4) is <strong>lame</strong>. It means that most guides out there for how to
quickly get started will only work if you&rsquo;re just stepping into modern web dev
<em>for the first time</em>&hellip; If you&rsquo;ve been using node and NPM, etc. for a while
you&rsquo;re likely running much newer versions of these tools and they&rsquo;re likely
installed globally. It also makes it appear there is a lack of commitment to
bringing development practices and patterns for SharePoint up to date and
keeping it there.</li>
<li>Let&rsquo;s hope that if we follow the instructions exactly things actually work. As
it&rsquo;s going to mean making some serious changes to the configuration of my dev
box and going outside the 1, 2, 3 hello world box.</li>
<li>Maybe there&rsquo;s some way to manage multiple versions of Node.js without
struggling&hellip;</li>
</ul>
<p>At this point, I&rsquo;ve got projects that use much later node and NPM versions. I
can&rsquo;t justify unintalling them just to have to do the same dance at a later
point to get them reinstalled. What to do? Let&rsquo;s look into
<a href="https://github.com/creationix/nvm">Node Version Manager (NVM), which allows you to manage and switch between different Node versions &ldquo;with ease&rdquo;</a>.
There&rsquo;s also
<a href="https://github.com/coreybutler/nvm-windows">nvm-windows for Windows users</a>.
Interested in how to get this setup? Read my post on
<a href="/2018/01/16/configuring-nvm-for-osx/">configuring NVM for Mac OS X</a>.</p>
<p>Now that I&rsquo;ve got NVM working and this project directory is using 6.11.5 &hellip;
let&rsquo;s continue on with the hello worlding.</p>
<ol>
<li>Browse to the directory for the project in terminal.</li>
<li>Initialize the project with NPM (to get our package.json)</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">npm init
</code></pre></div><ol start="3">
<li>Intall the npm package for the Yeoman SharePoint generator (locally).</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">npm install @microsoft/generator-sharepoint --save-dev
</code></pre></div><ol start="4">
<li>Open our project using our code editor of choice (have you tried Visual
Studio Code yet?)</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">code .
</code></pre></div><ol start="5">
<li>
<p>Notice that we&rsquo;ve got our .nvmrc file, our package.json file, and a directory
for node_modules. Things are looking good so far.</p>
</li>
<li>
<p>Let&rsquo;s run the Yeoman generator now.</p>
</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">yo @microsoft/sharepoint
</code></pre></div><ol start="7">
<li>
<p>We can&rsquo;t follow the next instruction to just run gulp serve, as gulp isn&rsquo;t
installed globally (I&rsquo;m not a fan of installing things globally as it makes
projects harder to get going on new workstations or by new developers). As
such, we need to change our package.json to handle running gulp for us.</p>
<p>We&rsquo;re going to add a script to trust the dev cert and another to serve.</p>
<ol>
<li>Open your package.json</li>
<li>Change the scripts section to be the following:</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#e6db74">&#34;scripts&#34;</span><span style="color:#960050;background-color:#1e0010">:</span> {
    <span style="color:#f92672">&#34;build&#34;</span>: <span style="color:#e6db74">&#34;gulp bundle&#34;</span>,
    <span style="color:#f92672">&#34;clean&#34;</span>: <span style="color:#e6db74">&#34;gulp clean&#34;</span>,
    <span style="color:#f92672">&#34;test&#34;</span>: <span style="color:#e6db74">&#34;gulp test&#34;</span>,
    <span style="color:#f92672">&#34;trust-dev-cert&#34;</span>: <span style="color:#e6db74">&#34;gulp trust-dev-cert&#34;</span>,
    <span style="color:#f92672">&#34;serve&#34;</span>: <span style="color:#e6db74">&#34;gulp serve&#34;</span>
}<span style="color:#960050;background-color:#1e0010">,</span>
</code></pre></div></li>
<li>
<p>Trust the Dev Cert used by workbench</p>
</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">npm run trust-dev-cert
</code></pre></div><ol start="9">
<li>Fire up the workbench</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">npm run serve
</code></pre></div><ol start="10">
<li>Marvel at it working and don&rsquo;t think about future version dependency
conflicts :)</li>
</ol>
        </article>
        
        <article>
            <h2>SharePoint: Search Managed Properties missing after full crawl</h2>
            <p>Scenario:</p>
<ul>
<li>SharePoint 2013</li>
<li>You&rsquo;ve created some site columns, added them to a content type, then added
that content type to a list/library.</li>
<li>You add some test data.</li>
<li>Run a full crawl.</li>
<li>Create managed properties, mapping them to the crawled properties.</li>
<li>Run another full crawl (to populate the managed properties)</li>
<li>Managed properties on search results are missing.</li>
</ul>
<p>What do you do now?</p>
<ul>
<li>Run another full crawl and check again.</li>
<li>Wonder why it&rsquo;s still not working.</li>
</ul>
<p>What else has worked for me? Clear the SharePoint Config Cache. This is
referenced in a
<a href="https://sharepoint.stackexchange.com/questions/122486/new-managed-properties-dont-contain-values">Stack Overflow Question</a>
and it references a
<a href="https://blogs.technet.microsoft.com/sp/?p=373">Technet article</a>. However, the
SO question is out of date with the article and the article has some incorrect
quotes, making copy+paste fail. Here&rsquo;s the technet article code cleaned up a
bit.</p>
<p>After clearing the config cache, run a full crawl. I&rsquo;ve had success in this
allowing Managed Properties to be populated with data and present when the above
steps didn&rsquo;t work.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">Add-PSSnapin -Name Microsoft.SharePoint.PowerShell -ErrorAction SilentlyContinue;

write-host <span style="color:#e6db74">&#34;CLEAR CONFIG CACHE ON FARM&#34;</span> <span style="color:#f92672">-F</span> Green;

$servers = get-spserver | ?{$_.role <span style="color:#f92672">-eq</span> <span style="color:#e6db74">&#34;Application&#34;</span>}
<span style="color:#66d9ef">foreach</span> ($server <span style="color:#66d9ef">in</span> $servers)
{
    $servername = $server.Address;
    write-host <span style="color:#e6db74">&#34;Stop Timer Service on server $servername&#34;</span> <span style="color:#f92672">-F</span> Yellow;
    (Get-WmiObject Win32_Service -filter <span style="color:#e6db74">&#34;name=&#39;SPTimerV4&#39;&#34;</span> -ComputerName $servername).stopservice() | Out-Null;
}

<span style="color:#66d9ef">foreach</span> ($server <span style="color:#66d9ef">in</span> $servers)
{
    $servername = $server.Address;
    $folders = Get-ChildItem (<span style="color:#e6db74">&#34;\\&#34;</span> + $servername + <span style="color:#e6db74">&#34;\C$\ProgramData\Microsoft\SharePoint\Config&#34;</span>);

    <span style="color:#66d9ef">foreach</span> ($folder <span style="color:#66d9ef">in</span> $folders)
    {
        $items = Get-ChildItem $folder.FullName -Recurse;
        <span style="color:#66d9ef">foreach</span> ($item <span style="color:#66d9ef">in</span> $items)
        {
            <span style="color:#66d9ef">if</span> ($item.Name.ToLower() <span style="color:#f92672">-eq</span> <span style="color:#e6db74">&#34;cache.ini&#34;</span>)
            {
                $cachefolder = $folder.FullName;
            }
        }
    }

    write-host <span style="color:#e6db74">&#34;Found CacheFolder on Server $servername = $cachefolder&#34;</span> <span style="color:#f92672">-F</span> Yellow;
    $cachefolderitems = Get-ChildItem $cachefolder -Recurse;

    write-host <span style="color:#e6db74">&#34;Delete all XMQL Files inside this CacheFolder&#34;</span> <span style="color:#f92672">-F</span> Yellow;
    <span style="color:#66d9ef">foreach</span> ($cachefolderitem <span style="color:#66d9ef">in</span> $cachefolderitems)
    {
        <span style="color:#66d9ef">if</span> ($cachefolderitem <span style="color:#f92672">-like</span> <span style="color:#e6db74">&#34;*.xml&#34;</span>)
        {
            $cachefolderitem.Delete();
        }
    }

    $a = Get-Content $cachefolder\cache.ini;
    $a = 1;
    write-host <span style="color:#e6db74">&#34;Creating a new Cache.ini File on server $servername&#34;</span> <span style="color:#f92672">-F</span> Yellow;
    Set-Content $a -Path $cachefolder\cache.ini;
}

<span style="color:#66d9ef">foreach</span> ($server <span style="color:#66d9ef">in</span> $servers)
{
    $servername = $server.Address;
    write-host <span style="color:#e6db74">&#34;START Timer Service on server $servername&#34;</span> <span style="color:#f92672">-F</span> Yellow;
    (Get-WmiObject Win32_Service -filter <span style="color:#e6db74">&#34;name=&#39;SPTimerV4&#39;&#34;</span> -ComputerName $servername).startservice() | Out-Null;
}
</code></pre></div>
        </article>
        
        <article>
            <h2>SharePoint: The server was unable to save the form at this time</h2>
            <p>We ran across an issue in a test environment where we were unable to add items
to a list, or a document library. However, you could use Windows explorer view
to upload a document.</p>
<p>The specific error message seen was:</p>
<pre><code>The server was unable to save the form at this time. Please try again.
</code></pre><p>Looking in the ULS log, there were odd messages dealing with authentication that
seemed to indicate that the Javascript CSOM was unable to process my request due
to conversion of Windows to Claims&hellip; but we&rsquo;re using Kerberos. What&rsquo;s up?</p>
<pre><code>Claims Windows Sign-In: Redirecting successfully signed-in user '&lt;user here&gt;' for request url 'https://your-sharepoint/_windows/default.aspx?ReturnUrl=/_vti.bin/client.svc/ProcessQuery'
</code></pre><p>There are several claimed ways to fix this error. They range from restarting
your server to enabling anonymous access (why anyone would resort to this is
beyond me). Luckily, I found a voice of sanity -
<a href="http://blog.isrichtig.de/Lists/Beitraege/Post.aspx?ID=128">Volker @ isrichtig.de&rsquo;s blog post &quot; ERROR on Newform.aspx in some Lists&quot;</a>.
Here are his steps, which worked in our case as well:</p>
<ul>
<li>Open the SharePoint Central Administration Web site, click Application
Management.</li>
<li>On the Application Management page, in the SharePoint Web Application
Management section, click Web application list.</li>
<li>On the Web Application List page, select your Web application.</li>
<li>Select Authentication providers from the ribbon.</li>
<li>Click Default.</li>
<li>Click Ok to save the provider again.</li>
</ul>
<p>Effectively, it looks like this resets your authentication settings for a
particular zone to what they&rsquo;re believed to be in the configuration database.
Why this got broke, I&rsquo;m not sure, but this was an easy fix that was only
enforcing the known settings anyway.</p>
        </article>
        
        <article>
            <h2>Muhimbi PDF Converter Services &amp; InfoPath Error</h2>
            <p>Ran across an error while proving out a new Muhimbi PDF Converter Services
install. I haven&rsquo;t seen it&rsquo;s like anywhere online, but managed to find a
resolution.</p>
<p>This is most easily demonstrated if you&rsquo;re running the Muhimbi Document
Converter Diagnostics tool from the server performing conversions:</p>
<ul>
<li>Author a new InfoPath form template and save it to C:\TEMP as form1.xsn</li>
<li>Fill out an instance of the form and save it to C:\TEMP as form1.xml</li>
<li>Use the diagnostics tool to attempt a conversion of the xml file.</li>
</ul>
<p>Here&rsquo;s the error:</p>
<blockquote>
<p>FaultException occurred: ExceptionType: Unknown
System.ServiceModel.FaultException`1[TestHarness.DocumentConverterService.WebServiceFaultException]:
Muhimbi.DocumentConverter.WebService.Data.WebServiceInternalException:
Exception of type
&lsquo;Muhimbi.DocumentConverter.WebService.Data.WebServiceInternalException&rsquo; was
thrown. - Details: &ldquo;Access is denied.&rdquo;</p>
</blockquote>
<p>However, all other conversions attempted were successful (tested Word and
PowerPoint). What&rsquo;s going on here?</p>
<p>For grins, I removed the additional Authentication settings I had applied in the
configuration file for converter services. Low and behold, the InfoPath
conversions started working. I added the authentication settings back, and I got
the same results as before&hellip;</p>
<p>The fix? You must add the account used to run the Muhimbi service to the group
you created that should be allowed to perform conversions. My bet is there is
some logic where the service calls itself through the port exposed, and there
the WCF service checks permissions and calls Access Denied.</p>
        </article>
        
        <article>
            <h2>K2 - Service Account Rights Issue</h2>
            <p>In two scenarios, errors wer observed when using K2 designer within
SharePoint 2013.</p>
<p>Working with K2 support, a resolution was found to this.</p>
<p>First, when trying to call a sub-workflow, the following error was observed:</p>
<blockquote>
<p>Unable to retrieve a list of sub-workflows from the server</p>
<p>User K2:[your service account here] has insufficient rights to perform action
GetProcSets. Minimum of Export rights are required to perform this action.</p>
</blockquote>
<p>Second, when attempting to delete a workflow from within the
SharePoint-integrated designer (after you click &ldquo;Application&rdquo; from the ribbon)
and you have one or both of the checkboxes ticket, the following error appears:</p>
<blockquote>
<p>User K2:[your service account here] does not have Administrator rights.</p>
</blockquote>
<p>The issue found was that the service account used to run the application pool
for the SmartForms designer did not have sufficient rights on the K2 server.
This looks to be a bug/edge-case with the installer, as it was consistently
present in multiple environments installed in the same fashion.</p>
<p>The easy fix? Go to your K2 Workspace, and open the Server Rights area. Add the
service account with Admin and Export rights. Done.</p>
        </article>
        
        <article>
            <h2>CMS Made Simple &amp; HostGator - Can&#39;t upload files</h2>
            <p>|-</p>
<p>I administer a CMS Made Simple site that runs on HostGator. I got a report from
a user that they couldn&rsquo;t upload any files. Strange! I checked it out, and
neither could I (through the web interface). I could upload a file straight to
the /uploads directory, but I couldn&rsquo;t delete the file. It would complain about
my actions being limited to the uploads folder&hellip; so it thought I wasn&rsquo;t in it?
Logged into HostGator&rsquo;s cPanel and found that my root path had changed from
/home to /home4 &hellip; no notice from HostGator about this, it just changed.
Changed the config.php of the CMS Made Simple site to have /home4 wherever /home
was before - all is working now.</p>
        </article>
        
        <article>
            <h2>CMS Made Simple - Post-Upgrade to v1.11.11</h2>
            <p>After finishing an upgrade of another site&rsquo;s CMS Made Simple to version 1.11.11,
I found that in certain areas I was seeing warning messages at the top of the
screen after editing calendar events within CGCalendar.</p>
<p>They looked like this:</p>
<p>[code] Warning: Cannot modify header information - headers already sent by
(output started at /home4/user/public_html/admin/moduleinterface.php:99) in
/home4/user/public_html/include.php on line 96</p>
<p>Warning: Cannot modify header information - headers already sent by (output
started at /home4/user/public_html/admin/moduleinterface.php:99) in
/home4/user/public_html/include.php on line 99</p>
<p>Warning: Cannot modify header information - headers already sent by (output
started at /home4/user/public_html/admin/moduleinterface.php:99) in
/home4/user/public_html/include.php on line 102</p>
<p>Warning: Cannot modify header information - headers already sent by (output
started at /home4/user/public_html/admin/moduleinterface.php:99) in
/home4/user/public_html/include.php on line 103</p>
<p>Warning: Cannot modify header information - headers already sent by (output
started at /home4/user/public_html/admin/moduleinterface.php:99) in
/home4/user/public_html/include.php on line 106</p>
<p>Warning: Cannot modify header information - headers already sent by (output
started at /home4/user/public_html/admin/moduleinterface.php:99) in
/home4/user/public_html/include.php on line 109 [/code]</p>
<p><!-- raw HTML omitted -->The Solution<!-- raw HTML omitted --> The solution I found was to change my
Administration Theme preference from the older &ldquo;NCleanGrey&rdquo; to the newer
&ldquo;OneEleven&rdquo;. This option is under My Preferences -&gt; My Account -&gt; User
Preferences.</p>
<p><!-- raw HTML omitted -->Tracing it down<!-- raw HTML omitted --> I&rsquo;m fairly new to PHP, having developed C#
primarily the last few years. However, I believe what&rsquo;s causing this is that
within the moduleinterface.php file (line 99), it&rsquo;s calling a &ldquo;ShowMessage&rdquo;
function that&rsquo;s supposed to exist within your preferred theme. The NCleanGrey
theme has no such function, while the newer OneEleven theme does. Why this lack
of a function causes it to yield these particular error messages, I have no
idea. I&rsquo;m trying to post a bug report on this, so perhaps it can be fixed in the
next version of CMSMS. Until then, I&rsquo;d suggest just using the new theme.</p>
        </article>
        
    </div>
</main>

    
    
    
</body>

</html>
