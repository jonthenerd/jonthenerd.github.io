<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>SharePoint: Search Managed Properties missing after full crawl &ndash; JonTheNerd</title>
    </head>

<body>
    
    <nav>
    <a href="/">JonTheNerd</a>
    <ul>
        <li><a href="/about">About</a></li>
    </ul>
</nav>
    
<h1>SharePoint: Search Managed Properties missing after full crawl</h1>
<p>Scenario:</p>
<ul>
<li>SharePoint 2013</li>
<li>You&rsquo;ve created some site columns, added them to a content type, then added
that content type to a list/library.</li>
<li>You add some test data.</li>
<li>Run a full crawl.</li>
<li>Create managed properties, mapping them to the crawled properties.</li>
<li>Run another full crawl (to populate the managed properties)</li>
<li>Managed properties on search results are missing.</li>
</ul>
<p>What do you do now?</p>
<ul>
<li>Run another full crawl and check again.</li>
<li>Wonder why it&rsquo;s still not working.</li>
</ul>
<p>What else has worked for me? Clear the SharePoint Config Cache. This is
referenced in a
<a href="https://sharepoint.stackexchange.com/questions/122486/new-managed-properties-dont-contain-values">Stack Overflow Question</a>
and it references a
<a href="https://blogs.technet.microsoft.com/sp/?p=373">Technet article</a>. However, the
SO question is out of date with the article and the article has some incorrect
quotes, making copy+paste fail. Here&rsquo;s the technet article code cleaned up a
bit.</p>
<p>After clearing the config cache, run a full crawl. I&rsquo;ve had success in this
allowing Managed Properties to be populated with data and present when the above
steps didn&rsquo;t work.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">Add-PSSnapin -Name Microsoft.SharePoint.PowerShell -ErrorAction SilentlyContinue;

write-host <span style="color:#e6db74">&#34;CLEAR CONFIG CACHE ON FARM&#34;</span> <span style="color:#f92672">-F</span> Green;

$servers = get-spserver | ?{$_.role <span style="color:#f92672">-eq</span> <span style="color:#e6db74">&#34;Application&#34;</span>}
<span style="color:#66d9ef">foreach</span> ($server <span style="color:#66d9ef">in</span> $servers)
{
    $servername = $server.Address;
    write-host <span style="color:#e6db74">&#34;Stop Timer Service on server $servername&#34;</span> <span style="color:#f92672">-F</span> Yellow;
    (Get-WmiObject Win32_Service -filter <span style="color:#e6db74">&#34;name=&#39;SPTimerV4&#39;&#34;</span> -ComputerName $servername).stopservice() | Out-Null;
}

<span style="color:#66d9ef">foreach</span> ($server <span style="color:#66d9ef">in</span> $servers)
{
    $servername = $server.Address;
    $folders = Get-ChildItem (<span style="color:#e6db74">&#34;\\&#34;</span> + $servername + <span style="color:#e6db74">&#34;\C$\ProgramData\Microsoft\SharePoint\Config&#34;</span>);

    <span style="color:#66d9ef">foreach</span> ($folder <span style="color:#66d9ef">in</span> $folders)
    {
        $items = Get-ChildItem $folder.FullName -Recurse;
        <span style="color:#66d9ef">foreach</span> ($item <span style="color:#66d9ef">in</span> $items)
        {
            <span style="color:#66d9ef">if</span> ($item.Name.ToLower() <span style="color:#f92672">-eq</span> <span style="color:#e6db74">&#34;cache.ini&#34;</span>)
            {
                $cachefolder = $folder.FullName;
            }
        }
    }

    write-host <span style="color:#e6db74">&#34;Found CacheFolder on Server $servername = $cachefolder&#34;</span> <span style="color:#f92672">-F</span> Yellow;
    $cachefolderitems = Get-ChildItem $cachefolder -Recurse;

    write-host <span style="color:#e6db74">&#34;Delete all XMQL Files inside this CacheFolder&#34;</span> <span style="color:#f92672">-F</span> Yellow;
    <span style="color:#66d9ef">foreach</span> ($cachefolderitem <span style="color:#66d9ef">in</span> $cachefolderitems)
    {
        <span style="color:#66d9ef">if</span> ($cachefolderitem <span style="color:#f92672">-like</span> <span style="color:#e6db74">&#34;*.xml&#34;</span>)
        {
            $cachefolderitem.Delete();
        }
    }

    $a = Get-Content $cachefolder\cache.ini;
    $a = 1;
    write-host <span style="color:#e6db74">&#34;Creating a new Cache.ini File on server $servername&#34;</span> <span style="color:#f92672">-F</span> Yellow;
    Set-Content $a -Path $cachefolder\cache.ini;
}

<span style="color:#66d9ef">foreach</span> ($server <span style="color:#66d9ef">in</span> $servers)
{
    $servername = $server.Address;
    write-host <span style="color:#e6db74">&#34;START Timer Service on server $servername&#34;</span> <span style="color:#f92672">-F</span> Yellow;
    (Get-WmiObject Win32_Service -filter <span style="color:#e6db74">&#34;name=&#39;SPTimerV4&#39;&#34;</span> -ComputerName $servername).startservice() | Out-Null;
}
</code></pre></div>

    
    
    
</body>

</html>
